{"type":"operationStart","subtype":"profile","data":{"_id":"URA1fLIk1LDxrGMy","timestamp":"2024-08-05T16:32:52.063Z","state":"queued","mode":"standard","creationDate":"2024-08-05T16:32:52.064Z","modificationDate":"2024-08-05T16:32:52.064Z","shortid":"oKoF-d-","inheritedReadPermissions":[],"inheritedEditPermissions":[],"$entitySet":"profiles"},"doDiffs":false,"timestamp":1722875572064,"id":"7usunwdu4dpq4pf","previousOperationId":null,"operationId":"o1el6230b4v2x51"}
{"type":"log","level":"info","message":"Render request 24 queued for execution and waiting for available worker","previousOperationId":"o1el6230b4v2x51","timestamp":1722875572064,"id":"31mwuhg5zlrik61"}
{"type":"operationStart","subtype":"render","name":"modules","previousOperationId":"o1el6230b4v2x51","timestamp":1722875572097,"id":"i6q1a313se90qvv","previousEventId":"7usunwdu4dpq4pf","operationId":"24g5rs85drnc1x2"}
{"type":"log","timestamp":1722875572097,"level":"info","message":"Starting rendering request 24 (user: admin)","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"vn5pwkx8rc7d87b","previousOperationId":"24g5rs85drnc1x2"}
{"type":"log","timestamp":1722875572097,"level":"info","message":"Rendering template { name: modules, recipe: xlsx, engine: handlebars, preview: true }","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"orot29gul9apd58","previousOperationId":"24g5rs85drnc1x2"}
{"type":"log","timestamp":1722875572097,"level":"debug","message":"Inline data specified.","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"0c5rcg7zrrz341q","previousOperationId":"24g5rs85drnc1x2"}
{"type":"log","timestamp":1722875572098,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"j94zhzw3i86f7j6","previousOperationId":"24g5rs85drnc1x2"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1722875572098,"id":"9us8086ufm9xiua","previousEventId":"i6q1a313se90qvv","operationId":"ln8y5ussu7hnto1","previousOperationId":"24g5rs85drnc1x2"}
{"type":"log","timestamp":1722875572098,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"ugsclt72rjxhqqf","previousOperationId":"ln8y5ussu7hnto1"}
{"type":"operationEnd","operationId":"ln8y5ussu7hnto1","timestamp":1722875572104,"id":"lw7wc5uvu66bnxn","previousEventId":"9us8086ufm9xiua","previousOperationId":"ln8y5ussu7hnto1"}
{"type":"operationStart","subtype":"recipe","name":"xlsx","timestamp":1722875572104,"id":"2tu0qfneuhor3ni","previousEventId":"lw7wc5uvu66bnxn","operationId":"3bbvsvxqto635ph","previousOperationId":"ln8y5ussu7hnto1"}
{"type":"log","timestamp":1722875572104,"level":"debug","message":"Executing recipe xlsx","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"zozmrjf20n35no5","previousOperationId":"3bbvsvxqto635ph"}
{"type":"log","timestamp":1722875572106,"level":"info","message":"xlsx generation is starting","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"hlbz90xwoubim3q","previousOperationId":"3bbvsvxqto635ph"}
{"type":"log","timestamp":1722875572132,"level":"debug","message":"Starting child request to render xlsx dynamic parts for generation step","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"x96512y3p80zxnq","previousOperationId":"3bbvsvxqto635ph"}
{"type":"operationStart","subtype":"render","name":"anonymous","previousOperationId":"3bbvsvxqto635ph","timestamp":1722875572132,"id":"5ukewpyn9nk7vpl","previousEventId":"2tu0qfneuhor3ni","operationId":"c5u7jmqdiaf3dl0"}
{"type":"log","timestamp":1722875572132,"level":"info","message":"Starting rendering (child) request (user: admin)","meta":{"rootId":"zfe5drwdne1hvd3","id":"wbggsdp6ulor4zk"},"id":"3xbmfapwzbgiwsk","previousOperationId":"c5u7jmqdiaf3dl0"}
{"type":"log","timestamp":1722875572132,"level":"info","message":"Rendering anonymous template { recipe: html, engine: handlebars }","meta":{"rootId":"zfe5drwdne1hvd3","id":"wbggsdp6ulor4zk"},"id":"t21ml8zdw7pkbsb","previousOperationId":"c5u7jmqdiaf3dl0"}
{"type":"log","timestamp":1722875572132,"level":"debug","message":"Inline data specified.","meta":{"rootId":"zfe5drwdne1hvd3","id":"wbggsdp6ulor4zk"},"id":"5la2e4qtg331rar","previousOperationId":"c5u7jmqdiaf3dl0"}
{"type":"log","timestamp":1722875572134,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"zfe5drwdne1hvd3","id":"wbggsdp6ulor4zk"},"id":"2s5xi8gg7saxpnc","previousOperationId":"c5u7jmqdiaf3dl0"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1722875572135,"id":"nq8zyla57pz17sz","previousEventId":"5ukewpyn9nk7vpl","operationId":"la94aw6vsnl2kta","previousOperationId":"c5u7jmqdiaf3dl0"}
{"type":"log","timestamp":1722875572135,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"zfe5drwdne1hvd3","id":"wbggsdp6ulor4zk"},"id":"4hhne3bvzzyigrx","previousOperationId":"la94aw6vsnl2kta"}
{"type":"log","timestamp":1722875572404,"level":"warn","message":"Error when processing (child) render request\n(because) error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n\n(sandbox.js line 8:48)\n\n   6 |\n   7 | function formatDate(isoString, format=\"dd/MM/yyyy hh:mm\") {\n>  8 |   return getDateTime(isoString).toLocaleString(DateTime.DATETIME_FULL);\n     |                                                ^\n   9 | }\n  10 |\n  11 | function simpleDate(isoString) {\n\n(sandbox.js line 12:10)\n\n  10 |\n  11 | function simpleDate(isoString) {\n> 12 |   return formatDate(isoString);\n     |          ^\n  13 | }\n  14 |\n  15 | function toC(val)\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 1810:39)\n\n  1808 |     newData.evaluatedLoopsIds.push(loopItem.id)\n  1809 |\n> 1810 |     const result = Handlebars.helpers.each(targetData, { ...optionsToUse, data: newData })\n       |                                       ^\n  1811 |\n  1812 |     loopItem.completed = true\n  1813 |\n\n(system-helpers.js line 1670:25)\n\n  1668 |     newData.outOfLoopTemplates = Object.create(null)\n  1669 |\n> 1670 |     return optionsToUse.fn(this, { data: newData })\n       |                         ^\n  1671 |   }\n  1672 |\n  1673 |   const getLoopItemById = (byTarget, loopItems) => {\n\n(sandbox.js line 30:18)\nReferenceError: DateTime is not defined\n  at formatDate (sandbox.js:8:48)\n  at Object.simpleDate (sandbox.js:12:10)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 35 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:368:156)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2251:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\nwrapped by:\nError: \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 35 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:368:156)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2251:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 16 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:191:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2105:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 16 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:191:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2105:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 15 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:173:138)\n  at prog (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at execIteration (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:51:19)\n  at Object.each (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:61:13)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 15 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:173:138)\n  at prog (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at execIteration (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:51:19)\n  at Object.each (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:61:13)\n  at Object.xlsxSData (system-helpers.js:1810:39)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 1 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:15:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 1 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:15:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:1670:25)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at Object.main (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:578:112)\n  at main (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:208:32)\n  at ret (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:212:12)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/handlebarsEngine.js:80:14)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at Object.main (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:578:112)\n  at main (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:208:32)\n  at ret (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:212:12)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/handlebarsEngine.js:80:14)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/worker.js:27:43)\n  at executionFn (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:260:42)\n  at eval (sandbox.js:30:18)\n  at async run (/app/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (/app/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:214:14)\n  at async executeEngine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:342:16)\nwrapped by:\nError: Error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at executeEngine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:365:35)\n  at async engine.engine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:146:14)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:61:23)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async WorkerReporter.render (/app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:181:12)\n  at async /app/node_modules/@jsreport/jsreport-xlsx/lib/generation/processXlsx.js:62:37\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/generation/index.js:58:28)\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/recipe.js:5:24)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:93:5)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/app/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)","meta":{"rootId":"zfe5drwdne1hvd3","id":"wbggsdp6ulor4zk"},"id":"jbxsron8li1fq9s","previousOperationId":"la94aw6vsnl2kta"}
{"type":"log","timestamp":1722875572404,"level":"warn","message":"Rendering (child) request finished with error in 341 ms","meta":{"rootId":"zfe5drwdne1hvd3","id":"wbggsdp6ulor4zk"},"id":"mwecxo4l8tmf4i9","previousOperationId":"la94aw6vsnl2kta"}
{"type":"log","timestamp":1722875572404,"level":"warn","message":"Error when processing render request 24\n(because) error while executing xlsx recipe\n(because) error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n\n(sandbox.js line 8:48)\n\n   6 |\n   7 | function formatDate(isoString, format=\"dd/MM/yyyy hh:mm\") {\n>  8 |   return getDateTime(isoString).toLocaleString(DateTime.DATETIME_FULL);\n     |                                                ^\n   9 | }\n  10 |\n  11 | function simpleDate(isoString) {\n\n(sandbox.js line 12:10)\n\n  10 |\n  11 | function simpleDate(isoString) {\n> 12 |   return formatDate(isoString);\n     |          ^\n  13 | }\n  14 |\n  15 | function toC(val)\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 1810:39)\n\n  1808 |     newData.evaluatedLoopsIds.push(loopItem.id)\n  1809 |\n> 1810 |     const result = Handlebars.helpers.each(targetData, { ...optionsToUse, data: newData })\n       |                                       ^\n  1811 |\n  1812 |     loopItem.completed = true\n  1813 |\n\n(system-helpers.js line 1670:25)\n\n  1668 |     newData.outOfLoopTemplates = Object.create(null)\n  1669 |\n> 1670 |     return optionsToUse.fn(this, { data: newData })\n       |                         ^\n  1671 |   }\n  1672 |\n  1673 |   const getLoopItemById = (byTarget, loopItems) => {\n\n(sandbox.js line 30:18)\nReferenceError: DateTime is not defined\n  at formatDate (sandbox.js:8:48)\n  at Object.simpleDate (sandbox.js:12:10)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 35 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:368:156)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2251:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\nwrapped by:\nError: \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 35 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:368:156)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2251:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 16 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:191:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2105:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 16 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:191:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2105:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 15 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:173:138)\n  at prog (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at execIteration (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:51:19)\n  at Object.each (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:61:13)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 15 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:173:138)\n  at prog (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at execIteration (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:51:19)\n  at Object.each (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:61:13)\n  at Object.xlsxSData (system-helpers.js:1810:39)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 1 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:15:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 1 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:15:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:1670:25)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at Object.main (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:578:112)\n  at main (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:208:32)\n  at ret (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:212:12)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/handlebarsEngine.js:80:14)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at Object.main (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:578:112)\n  at main (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:208:32)\n  at ret (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:212:12)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/handlebarsEngine.js:80:14)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/worker.js:27:43)\n  at executionFn (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:260:42)\n  at eval (sandbox.js:30:18)\n  at async run (/app/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (/app/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:214:14)\n  at async executeEngine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:342:16)\nwrapped by:\nError: Error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at executeEngine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:365:35)\n  at async engine.engine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:146:14)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:61:23)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async WorkerReporter.render (/app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:181:12)\n  at async /app/node_modules/@jsreport/jsreport-xlsx/lib/generation/processXlsx.js:62:37\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/generation/index.js:58:28)\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/recipe.js:5:24)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:93:5)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/app/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)\nwrapped by:\nError: Error while executing xlsx recipe\n(because) error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n\n(sandbox.js line 8:48)\n\n   6 |\n   7 | function formatDate(isoString, format=\"dd/MM/yyyy hh:mm\") {\n>  8 |   return getDateTime(isoString).toLocaleString(DateTime.DATETIME_FULL);\n     |                                                ^\n   9 | }\n  10 |\n  11 | function simpleDate(isoString) {\n\n(sandbox.js line 12:10)\n\n  10 |\n  11 | function simpleDate(isoString) {\n> 12 |   return formatDate(isoString);\n     |          ^\n  13 | }\n  14 |\n  15 | function toC(val)\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 1810:39)\n\n  1808 |     newData.evaluatedLoopsIds.push(loopItem.id)\n  1809 |\n> 1810 |     const result = Handlebars.helpers.each(targetData, { ...optionsToUse, data: newData })\n       |                                       ^\n  1811 |\n  1812 |     loopItem.completed = true\n  1813 |\n\n(system-helpers.js line 1670:25)\n\n  1668 |     newData.outOfLoopTemplates = Object.create(null)\n  1669 |\n> 1670 |     return optionsToUse.fn(this, { data: newData })\n       |                         ^\n  1671 |   }\n  1672 |\n  1673 |   const getLoopItemById = (byTarget, loopItems) => {\n\n(sandbox.js line 30:18)\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at /app/node_modules/@jsreport/jsreport-xlsx/lib/generation/processXlsx.js:116:20\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/generation/index.js:58:28)\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/recipe.js:5:24)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:93:5)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/app/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"dq4sqlkrgt667a7","previousOperationId":"3bbvsvxqto635ph"}
{"type":"log","timestamp":1722875572404,"level":"warn","message":"Rendering request 24 finished with error in 341 ms","meta":{"rootId":"zfe5drwdne1hvd3","id":"zfe5drwdne1hvd3"},"id":"105koa8gqks0ofh","previousOperationId":"3bbvsvxqto635ph"}
{"type":"error","timestamp":1722875572408,"lineNumber":8,"property":"helpers","statusCode":400,"weak":true,"logged":true,"previousOperationId":"3bbvsvxqto635ph","id":"3p0l1oueefh77rt","stack":"ReferenceError: DateTime is not defined\n  at formatDate (sandbox.js:8:48)\n  at Object.simpleDate (sandbox.js:12:10)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 35 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:368:156)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2251:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\nwrapped by:\nError: \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 35 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:368:156)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2251:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 34 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:352:115)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2218:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 16 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:191:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2105:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 16 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:191:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:2105:33)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 15 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:173:138)\n  at prog (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at execIteration (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:51:19)\n  at Object.each (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:61:13)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 15 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:173:138)\n  at prog (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at execIteration (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:51:19)\n  at Object.each (/app/node_modules/handlebars/dist/cjs/handlebars/helpers/each.js:61:13)\n  at Object.xlsxSData (system-helpers.js:1810:39)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 1 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:15:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at 1 (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:15:112)\n  at Object.prog [as fn] (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:268:12)\n  at Object.xlsxSData (system-helpers.js:1670:25)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:429:23)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at Object.main (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:578:112)\n  at main (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:208:32)\n  at ret (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:212:12)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/handlebarsEngine.js:80:14)\nwrapped by:\nError: \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at getEnhancedHelperError (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:425:54)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:431:15)\n  at Object.<anonymous> (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:407:27)\n  at Object.wrapper (/app/node_modules/handlebars/dist/cjs/handlebars/internal/wrapHelper.js:15:19)\n  at Object.main (eval at <anonymous> (eval at makeEvaluate (/app/node_modules/@jsreport/ses/index.js:6197:27)), <anonymous>:578:112)\n  at main (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:208:32)\n  at ret (/app/node_modules/handlebars/dist/cjs/handlebars/runtime.js:212:12)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/handlebarsEngine.js:80:14)\n  at Object.execute (/app/node_modules/@jsreport/jsreport-handlebars/lib/worker.js:27:43)\n  at executionFn (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:260:42)\n  at eval (sandbox.js:30:18)\n  at async run (/app/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (/app/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:214:14)\n  at async executeEngine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:342:16)\nwrapped by:\nError: Error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at executeEngine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:365:35)\n  at async engine.engine (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:146:14)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:61:23)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async WorkerReporter.render (/app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:181:12)\n  at async /app/node_modules/@jsreport/jsreport-xlsx/lib/generation/processXlsx.js:62:37\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/generation/index.js:58:28)\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/recipe.js:5:24)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:93:5)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/app/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)\nwrapped by:\nError: Error while executing xlsx recipe\n(because) error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n\n(sandbox.js line 8:48)\n\n   6 |\n   7 | function formatDate(isoString, format=\"dd/MM/yyyy hh:mm\") {\n>  8 |   return getDateTime(isoString).toLocaleString(DateTime.DATETIME_FULL);\n     |                                                ^\n   9 | }\n  10 |\n  11 | function simpleDate(isoString) {\n\n(sandbox.js line 12:10)\n\n  10 |\n  11 | function simpleDate(isoString) {\n> 12 |   return formatDate(isoString);\n     |          ^\n  13 | }\n  14 |\n  15 | function toC(val)\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 1810:39)\n\n  1808 |     newData.evaluatedLoopsIds.push(loopItem.id)\n  1809 |\n> 1810 |     const result = Handlebars.helpers.each(targetData, { ...optionsToUse, data: newData })\n       |                                       ^\n  1811 |\n  1812 |     loopItem.completed = true\n  1813 |\n\n(system-helpers.js line 1670:25)\n\n  1668 |     newData.outOfLoopTemplates = Object.create(null)\n  1669 |\n> 1670 |     return optionsToUse.fn(this, { data: newData })\n       |                         ^\n  1671 |   }\n  1672 |\n  1673 |   const getLoopItemById = (byTarget, loopItems) => {\n\n(sandbox.js line 30:18)\n  at module.exports (/app/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/app/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at /app/node_modules/@jsreport/jsreport-xlsx/lib/generation/processXlsx.js:116:20\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/generation/index.js:58:28)\n  at async module.exports (/app/node_modules/@jsreport/jsreport-xlsx/lib/recipe.js:5:24)\n  at async invokeRender (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:93:5)\n  at async WorkerReporter._render (/app/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /app/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/app/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)","message":"Error while executing xlsx recipe\n(because) error when evaluating engine handlebars for template anonymous\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"xlsxSData\" helper call failed\n(because) \"simpleDate\" helper call failed\n(because) dateTime is not defined\n\n(sandbox.js line 8:48)\n\n   6 |\n   7 | function formatDate(isoString, format=\"dd/MM/yyyy hh:mm\") {\n>  8 |   return getDateTime(isoString).toLocaleString(DateTime.DATETIME_FULL);\n     |                                                ^\n   9 | }\n  10 |\n  11 | function simpleDate(isoString) {\n\n(sandbox.js line 12:10)\n\n  10 |\n  11 | function simpleDate(isoString) {\n> 12 |   return formatDate(isoString);\n     |          ^\n  13 | }\n  14 |\n  15 | function toC(val)\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2251:33)\n\n  2249 |   ) {\n  2250 |     const newData = Handlebars.createFrame(optionsToUse.data)\n> 2251 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2252 |\n  2253 |     if (\n  2254 |       optionsToUse?.data?.currentCellValueInfo != null &&\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2218:33)\n\n  2216 |     }\n  2217 |\n> 2218 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2219 |     const enabledForCol = newData.meta.autofit.enabledFor[0] === true ? true : newData.meta.autofit.enabledFor.includes(newData.columnLetter)\n  2220 |\n  2221 |     if (enabledForCol) {\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 2105:33)\n\n  2103 |     newData.currentCellRef = null\n  2104 |\n> 2105 |     const result = optionsToUse.fn(this, { data: newData })\n       |                                 ^\n  2106 |\n  2107 |     return result\n  2108 |   }\n\n(system-helpers.js line 1810:39)\n\n  1808 |     newData.evaluatedLoopsIds.push(loopItem.id)\n  1809 |\n> 1810 |     const result = Handlebars.helpers.each(targetData, { ...optionsToUse, data: newData })\n       |                                       ^\n  1811 |\n  1812 |     loopItem.completed = true\n  1813 |\n\n(system-helpers.js line 1670:25)\n\n  1668 |     newData.outOfLoopTemplates = Object.create(null)\n  1669 |\n> 1670 |     return optionsToUse.fn(this, { data: newData })\n       |                         ^\n  1671 |   }\n  1672 |\n  1673 |   const getLoopItemById = (byTarget, loopItems) => {\n\n(sandbox.js line 30:18)"}
